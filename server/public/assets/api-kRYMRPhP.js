class i{constructor(){this.baseURL=window.location.origin,this.token=null;const e=localStorage.getItem("currentUser")||sessionStorage.getItem("currentUser");if(e)try{const s=JSON.parse(e);this.token=s.token||s.access_token}catch(s){console.error("Error parsing saved user:",s)}}async request(e,s={}){try{console.log("Making request to:",e),console.log("Current token:",this.token?"YES":"NO");const o=`${this.baseURL}${e}`,n={"Content-Type":"application/json",...s.headers};this.token?(n.Authorization=`Bearer ${this.token}`,console.log("Sending Authorization header with token")):console.log("No token available!"),console.log("ðŸ“¨ Request headers:",n);const a={...s,headers:n,credentials:"include"},t=await fetch(o,a);console.log(`Response status: ${t.status} ${t.statusText}`);const r=await t.json();if(console.log("Response data:",r),!t.ok)throw new Error(r.error||r.message||`HTTP error! status: ${t.status}`);return r}catch(o){throw console.error("API request failed:",o),o}}setToken(e){this.token=e,console.log("Token set:",e?e.substring(0,20)+"...":"NULL")}clearToken(){this.token=null}async register(e){return await this.request("/api/auth/register",{method:"POST",body:JSON.stringify(e)})}async login(e){const s=await this.request("/api/auth/login",{method:"POST",body:JSON.stringify(e)});return console.log("Login response token:",s.token?"RECEIVED":"MISSING"),(s.token||s.access_token)&&this.setToken(s.token||s.access_token),s}async getUserProfile(){return this.request("/api/users/profile")}async updateUserProfile(e){return console.log("Updating profile with data:",e),this.request("/api/users/profile",{method:"PUT",body:JSON.stringify(e)})}async changeEmail(e){return this.request("/api/users/email",{method:"PUT",body:JSON.stringify(e)})}async changeUsername(e){return this.request("/api/users/username",{method:"PUT",body:JSON.stringify(e)})}async changePassword(e){return this.request("/api/users/password",{method:"PUT",body:JSON.stringify(e)})}async getAllUsers(){return this.request("/api/users")}async deleteAccount(e){return this.request("/api/users/account",{method:"DELETE",body:JSON.stringify(e)})}logout(){this.clearToken()}}const u=new i;export{u as a};
